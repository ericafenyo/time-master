<!DOCTYPE html>
<html>

<head>
    <title>WebSocket Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
</head>

<body>
    <input type="text" id="messageInput" placeholder="Enter message">
    <button onclick="sendMessage()">Send</button>
    <div id="messageOutput"></div>

    <script>
        const stompClient = new StompJs.Client({
            brokerURL: 'ws://localhost:3000/websocket'
        });

        stompClient.activate();

        stompClient.onConnect = (frame) => {
            console.log('Connected: ' + frame);

            stompClient.subscribe('/topic/greetings', (greeting) => {
                const messageOutput = document.getElementById('messageOutput');
                messageOutput.innerHTML += `<p>Received: ${JSON.parse(greeting.body).message}</p>`;
                // showGreeting(JSON.parse(greeting.body).content);
            });
        };

        // stompClient.onWebSocketError = (error) => {
        //     console.error('Error with websocket', error);
        // };

        // stompClient.onStompError = (frame) => {
        //     console.error('Broker reported error: ' + frame.headers['message']);
        //     console.error('Additional details: ' + frame.body);
        // };

        // function connect() {
        //     stompClient.activate();
        // }

        // function sendName() {
        //     stompClient.publish({
        //         destination: "/app/hello",
        //         body: JSON.stringify({ 'name': $("#name").val() })
        // });
        // }


        // socket.onopen = function (event) {
        //     console.log('WebSocket connection opened');
        // };

        // socket.onmessage = function (event) {
        //     const messageOutput = document.getElementById('messageOutput');
        //     messageOutput.innerHTML += `<p>Received: ${event.data}</p>`;
        // };

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value;

            stompClient.publish({
                destination: "/hello",
                body: JSON.stringify({ 'name': message })
            });

            messageInput.value = '';
        }
    </script>
</body>

</html>